"0","B <- 2000"
"0","n <- length(y)"
"0",""
"0","lambda_star <- numeric(B)"
"0",""
"0","for (b in 1:B) {"
"0","  idx <- sample.int(n, size = n, replace = TRUE)"
"0","  y_b <- y[idx]"
"0","  d_b <- delta[idx]"
"0","  lambda_star[b] <- sum(d_b) / sum(y_b)"
"0","}"
"0",""
"0","se_boot <- sd(lambda_star)"
"0","ci_boot <- quantile(lambda_star, probs = c(0.025, 0.975), names = FALSE)"
"0",""
"0","cat(sprintf(""Bootstrap: SE = %.6f\n"", se_boot))"
"1","Bootstrap: SE = 0.000876
"
"0","cat(sprintf(""Bootstrap 95%% CI: (%.6f, %.6f)\n"", ci_boot[1], ci_boot[2]))"
"1","Bootstrap 95% CI: (0.006176, 0.009687)
"
